<template>
	<div class="fx67ll-box">
		<!-- ÁÇπÂáªÈáçÊñ∞ÂºÄÂßãÂä®Áîª -->
		<div id="fx67ll-typical" class="fx67ll-tip" @click="repeatAnimation()">Ô∏è</div>
		<!-- <div id="fx67ll-typical" class="fx67ll-tip"></div> -->
		<div class="fx67ll-clock"></div>
		<div class="fx67ll-record">
			<span id="fx67ll-record-start">From 2021-08-23 ü•≥ </span>
			&nbsp;&nbsp;&nbsp;
			<span id="fx67ll-record-end">To 2021-11-13 ü•∂ </span>
		</div>
	</div>
</template>

<script>
	import FlipClock from 'flipclock';
	import 'flipclock/dist/flipclock.css';
	import moment from 'moment';
	import {
		type,
		type as loop
	} from '@camwiegert/typical';
	export default {
		name: 'fx67llIndex',
		data() {
			return {
				meetHerDays: 0,
				chnNumChar: ["Èõ∂", "‰∏Ä", "‰∫å", "‰∏â", "Âõõ", "‰∫î", "ÂÖ≠", "‰∏É", "ÂÖ´", "‰πù"],
				chnUnitSection: ["", "‰∏á", "‰∫ø", "‰∏á‰∫ø", "‰∫ø‰∫ø"],
				chnUnitChar: ["", "ÂçÅ", "Áôæ", "ÂçÉ"]
			};
		},
		mounted() {
			this.initStuDays();
			this.initClock();
			this.typeMyWords();
			this.consoleFailDays();
			this.breathAnimation();
		},
		methods: {
			// ÈáçÂ§çÂä®Áîª
			repeatAnimation() {
				this.typeMyWords();
				this.breathAnimation();
			},
			// ÊòæÁ§∫‰∏Ä‰∏ãÊîªÁï•ÁöÑÂºÄÂßãÁªìÊùüÊó∂Èó¥
			breathAnimation() {
				// document.getElementById("fx67ll-record-start").setAttribute("class", "fx67ll-record-animation-breath");
				document.getElementById("fx67ll-record-start").style.animation = "breath 5.4s linear 2 alternate";
				setTimeout(function() {
					// document.getElementById("fx67ll-record-end").setAttribute("class",
					// 	"fx67ll-record-animation-breath");
					document.getElementById("fx67ll-record-end").style.animation = "breath 5.4s linear 2 alternate";
				}, 5400);
				document.getElementById("fx67ll-record-start").addEventListener("animationend", function() {
					document.getElementById("fx67ll-record-start").style.animation = "";
				});
				document.getElementById("fx67ll-record-end").addEventListener("animationend", function() {
					document.getElementById("fx67ll-record-end").style.animation = "";
				});
			},
			// Â§±Ë¥•Êó•
			consoleFailDays() {
				let failDays = moment(moment('20211113').format('YYYY-MM-DD')).diff(moment('20210823').format(
						'YYYY-MM-DD'),
					'day');
				console.log('fx67llÂ∑≤‰∫é2021Âπ¥11Êúà13Êó•Ëé∑ÂæóÂ§±Ë¥•ÔºåÊú¨Ê¨°ÊîªÁï•Êó∂Èó¥‰ªÖ' + failDays + 'Â§©');
			},
			// ÊâìÂç∞‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑÂÜÖÂÆπ
			typeMyWords() {
				// Âæ™ÁéØÊâìÂç∞
				// const element = document.querySelector('#fx67ll-typical');
				// const myWordsFirst = "ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~ÊµãËØï~";
				// const myWordsSecond = "ÁªßÁª≠ÊµãËØïÔºÅÁªßÁª≠ÊµãËØïÔºÅÁªßÁª≠ÊµãËØïÔºÅÁªßÁª≠ÊµãËØïÔºÅÁªßÁª≠ÊµãËØïÔºÅÁªßÁª≠ÊµãËØïÔºÅ";
				// const myWordsThird = "ËøòÊòØÂú®ÊµãËØïÂìàÂìà///ËøòÊòØÂú®ÊµãËØïÂìàÂìà///ËøòÊòØÂú®ÊµãËØïÂìàÂìà";
				// const steps = [1000, myWordsFirst, 1000, myWordsSecond, 1000, myWordsThird];
				// type(element, ...steps, loop);

				// ÊâìÂç∞ÂÆå‰πãÂêéËá™Âä®ÂÅúÊ≠¢
				const element = document.querySelector('#fx67ll-typical');
				const myWordsFirst = "‚õ∞Ô∏è ËôΩÁÑ∂Ôºå‰∏çÂ§™ÊàêÁÜüÁöÑÊàëËôΩÁÑ∂Ê≤°ËÉΩÂê∏ÂºïÂà∞‰Ω† üíñ";
				const myWordsSecond = "üòù ‰ΩÜÊòØÔºåÂæàÈ´òÂÖ¥ËÉΩÂú®ËøôÂ∞èÂ∞èÁöÑÂÆáÂÆôÈáåÈÅáËßÅ‰Ω† üåè";
				const myWordsThird = "üì∑ ÊâÄ‰ª•ÔºåÊàëËøòÊòØÊÉ≥ËÆ∞ÂΩï‰∏ãËøô‰∏™Âú®ÊàëÁîüÂëΩ‰∏≠ÂæàÈáçË¶ÅÁöÑÁû¨Èó¥ üï∞Ô∏è";
				const myWordsFourth = "‚ú®Ô∏è ‰ªäÂ§©ÊòØËÆ§ËØÜ yu ÁöÑÁ¨¨" + this.meetHerDays + "Â§©" + " ‚ù§Ô∏è";
				type(element, myWordsFirst, 2000, myWordsSecond, 2000, myWordsThird, 2000, myWordsFourth);
			},
			// Â§©Êï∞ËÆ°ÁÆó
			initStuDays() {
				let meetHerDays = moment(moment().format('YYYY-MM-DD')).diff(moment('20210823').format('YYYY-MM-DD'),
					'day');
				this.meetHerDays = this.NumberToChinese(meetHerDays);
			},
			// Êó∂ÈíüÂàùÂßãÂåñ
			initClock() {
				const el = document.querySelector('.fx67ll-clock');
				const clock = new FlipClock(el, new Date('2021-08-23'), {
					face: 'DayCounter', // Á±ªÂûã  
					showSeconds: true, // ÊòæÁ§∫ÁßíÊï∞  
					showLabels: true, // ÊòæÁ§∫ÊñáÂ≠óÊ†áËØÜ  
					language: {
						'years': 'Âπ¥',
						'months': 'Êúà',
						'days': 'Êó•',
						'hours': 'ÊôÇ',
						'minutes': 'ÂàÜ',
						'seconds': 'Áßí'
					},
					countdown: false, // true‰∏∫ÂÄíËÆ°Êó∂
				});
			},
			// ÈòøÊãâ‰ºØÊï∞Â≠óËΩ¨Êç¢Ê±âÂ≠óÊï∞Â≠ó
			NumberToChinese(num) {
				var unitPos = 0;
				var strIns = '',
					chnStr = '';
				var needZero = false;

				if (num === 0) {
					return this.chnNumChar[0];
				}

				while (num > 0) {
					var section = num % 10000;
					if (needZero) {
						chnStr = this.chnNumChar[0] + chnStr;
					}
					strIns = this.SectionToChinese(section);
					strIns += (section !== 0) ? this.chnUnitSection[unitPos] : this.chnUnitSection[0];
					chnStr = strIns + chnStr;
					needZero = (section < 1000) && (section > 0);
					num = Math.floor(num / 10000);
					unitPos++;
				}

				if (chnStr.substring(0, 1) === '‰∏Ä' && chnStr.substring(1, 2) === 'ÂçÅ') {
					chnStr = chnStr.substr(1, chnStr.length)
				}

				return chnStr;
			},
			// ËäÇÂÜÖËΩ¨Êç¢ÁÆóÊ≥ï
			SectionToChinese(section) {
				var strIns = '',
					chnStr = '';
				var unitPos = 0;
				var zero = true;
				while (section > 0) {
					var v = section % 10;
					if (v === 0) {
						if (!zero) {
							zero = true;
							chnStr = this.chnNumChar[v] + chnStr;
						}
					} else {
						zero = false;
						strIns = this.chnNumChar[v];
						strIns += this.chnUnitChar[unitPos];
						chnStr = strIns + chnStr;
					}
					unitPos++;
					section = Math.floor(section / 10);
				}
				return chnStr;
			}
		}
	};
</script>
<style type="text/css">
	.flip-clock {
		font-size: 2vw;
		justify-content: center;
	}

	@keyframes breath {
		from {
			opacity: 0;
		}

		to {
			opacity: 1;
		}
	}
</style>
<style lang="less" scoped="scoped">
	.fx67ll-box {
		width: 100%;
		height: 100%;
		overflow: hidden;
		.ban-user-select();

		.fx67ll-tip {
			width: 100%;
			text-align: center;
			font-size: 50px;
			color: #2ECC71;
			position: absolute;
			top: 15%;
		}

		.fx67ll-clock {
			position: relative;
			top: 60%;
			margin-top: -10vw;
		}

		.fx67ll-record {
			width: 100%;
			position: absolute;
			bottom: 10vw;
			display: flex;
			justify-content: center;
			font-size: 30px;
			font-weight: 900;
			color: #2ECC71;

			span {
				position: relative;
				opacity: 0;
			}

		}
	}

	// .fx67ll-record-animation-breath {
	// 	animation: breath 5s linear 2 alternate;
	// }

	// @keyframes breath {
	// 	from {
	// 		opacity: 0;
	// 	}

	// 	to {
	// 		opacity: 1;
	// 	}
	// }
</style>
